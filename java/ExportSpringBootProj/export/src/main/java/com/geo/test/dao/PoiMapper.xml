<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.geo.test.dao.PoiMapper">
	<!-- 数据库和实体类映射 -->
	<resultMap id="BaseResultMap"
		type="com.geo.test.entity.Poi">
		<result column="id" jdbcType="INTEGER" property="id" />
		<result column="gps_x" jdbcType="NUMERIC" property="gps_x" />
		<result column="gps_y" jdbcType="NUMERIC" property="gps_y" />
	</resultMap>

	<!-- 输出结构定义 -->
	<sql id="Base_Column_List">id,gps_x,gps_y</sql>

	<!-- 查找列表 -->
	<select id="findList" parameterType="com.geo.test.entity.Poi" resultMap="BaseResultMap">
		select 
			<include refid="Base_Column_List"></include>
		from poidata
		<trim prefix="where" prefixOverrides="and|or">
			<if test="id !='' and id != null">
				and id = #{id,jdbcType=INTEGER}
			</if>
			<if test="gps_x !='' and gps_x != null">
				and gps_x = #{gps_x,jdbcType=NUMERIC}
			</if>
			<if test="gps_y !='' and gps_y != null">
				and gps_y = #{gps_y,jdbcType=NUMERIC}
			</if>
			<if test="searchstr !='' and searchstr !=null" >
				and name like CONCAT(CONCAT('%', #{searchstr}), '%')
			</if>
     	</trim>
     	<if test="sort !='' and sort !=null" >
				order by  ${sort}
		</if>
	</select>
	
	<!-- 新添加的sql -->
	
	<!-- 添加 -->
	<insert id="insertSelective" parameterType="com.geo.test.entity.Poi">
		insert into poidata 
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id !='' and id != null">
				id,
			</if>
			<if test="gps_x !='' and gps_x != null">
				gps_x,
			</if>
			<if test="gps_y !='' and gps_y != null">
				gps_y,
			</if>
     	</trim>
		values
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id !='' and id != null">
				#{id,jdbcType=INTEGER}, 
			</if>
			<if test="gps_x !='' and gps_x != null">
				#{gps_x,jdbcType=NUMERIC}, 
			</if>
			<if test="gps_y !='' and gps_y != null">
				#{gps_y,jdbcType=NUMERIC}, 
			</if>
		</trim>
	</insert>
	
	<!-- 删除 -->
	<delete id="deleteByKey" parameterType="String">
		delete from poidata
		where id = #{id,jdbcType=VARCHAR}
	</delete>
	
	<!-- 批量删除 -->
	<delete id="deleteInBatch" parameterType="java.util.List">
		delete from poidata
		where id in 
		<foreach collection="list" item="id" open="(" close=")" separator="," >
	         #{id,jdbcType=VARCHAR}
	    </foreach>
	</delete>

	<!-- 修改 -->
	<update id="updateByKey" parameterType="com.geo.test.entity.Poi">
		update poidata 
		<trim prefix="set" suffixOverrides=",">
				<if test="gps_x != '' and gps_x != null">
					gps_x = #{gps_x,jdbcType=NUMERIC},
				</if>
				<if test="gps_y != '' and gps_y != null">
					gps_y = #{gps_y,jdbcType=NUMERIC},
				</if>
		</trim>
		where id = #{id,jdbcType=VARCHAR}
	</update>
	
	<!-- 依据id查找 -->
	<select id="findByKey" parameterType="String" resultMap="BaseResultMap">
		select 
			<include refid="Base_Column_List"></include>
			from poidata
    	where id=#{id,jdbcType=VARCHAR}
	</select>
	
</mapper>